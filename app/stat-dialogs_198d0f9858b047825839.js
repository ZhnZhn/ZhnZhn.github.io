"use strict";(self.webpackChunkweb_app_erc=self.webpackChunkweb_app_erc||[]).push([[301],{4965:(t,e,o)=>{o.d(e,{default:()=>Lt});var s=o(1315),n=o(4558),i=o(9288),r=o(2655),a=o(7104),c=o(3375),d=o(7071),l=o(9759),p=o(9878),u=o(8355),h=o(3349),m=o(2357),f=o(5317);const g="_is",v=t=>"is"+t;var y=o(4848);const O={wordBreak:"break-word"},b=(t,e,o)=>(0,y.jsx)(m.A,{isShow:!o.isRow[v(t.id)],children:(0,y.jsx)(f.A,{captionStyle:O,caption:t.caption,placeholder:t.placeholder,options:t.options,isShowLabels:o.isShowLabels,onSelect:o.fSelect(e)})},t.id);var w=o(4575),S=o(4250),C=o(5286),A=o(3941),I=o(4302),x=o(2783);const T=()=>{const t=(0,s.li)([]),e=(0,s.hb)((e=>o=>{t.current[e]=o?Object.assign({},o):void 0}),[]);return[t,e]};var F=o(3416),L=o(4066),j=o(4867);const q=t=>{const[e,o]=(0,j.Hn)({[g]:!0}),[n,i]=(0,s.Kr)((()=>[t=>o(v(t)),()=>o(g)]),[o]);return(0,s.vJ)((()=>{o(t.reduce(((t,e)=>(e.dfItem&&(t[v(e.id)]=!0),t)),{}))}),[t,o]),[e,n,i]};var M=o(6081);const D=t=>{const[e,o,n,i,r]=(0,F.A)(),[a,c,d]=q(t),l=a[g],[p,u,h]=(0,L.A)();return[(0,s.Kr)((()=>(0,y.jsx)(M.A,{isShow:e,selectProps:t,isShowLabels:i,isShowChart:l,isCh:t.length>2,onToggleLabels:r,onToggle:c,onToggleChart:d,onCheckCaption:u,onUnCheckCaption:h,onClose:n})),[e,t,i,l]),p,i,a,o]};var E=o(8248),k=o(4428);const P=class{constructor(t){void 0===t&&(t=5e3),this.mls=t,this.isLoading=!1}start(t){return!this.isLoading&&(this.loadingUrl=t,this.isLoading=!0,this.timeoutId=setTimeout((()=>{t===this.loadingUrl&&(this.isLoading=!1)}),this.mls),!0)}stop(){this.isLoading=!1,clearTimeout(this.timeoutId)}};var _=o(2823),J=o(3730);const N="time",R="Geo Entity";var U=o(9009);const B=(t,e,o)=>({caption:t,slice:{[e]:o}}),Q=t=>(t||"").split("_").map(U.O).join(" "),Y=(t,e)=>{const{label:o}=t||{};return(0,J.Co)(o).map((t=>({caption:o[t],value:t,id:e})))},Z=t=>{for(let e=0;e<t.length;e++){const o=t[e]||{};if("freq"===o.v)return((o.options||[])[0]||{}).value}},H=t=>{const e=[null],o=[];(0,J.Co)(t).forEach((s=>{if(s!==N){const n=t[s],{label:i,category:r}=n||{},a={c:Q(i),v:s,options:Y(r,s)};"s_adj"===s?(a.c="Seasonal Adjustment",a.options=(t=>t.options.map((t=>(t.sc=t.value,t.caption=t.caption+" ("+t.value+")",t))))(a),o.push(a)):"geo"===s?(a.c=R,e[0]=a):e.push(a)}}));const s=(0,_.Bo)(e).concat(o);return{dims:s,mapFrequency:Z(s),timeId:N}},K=t=>{let{values:e,id:o}=t;return(e||[]).map((t=>B(t.text,o,t.id)))},V=t=>{const e=[];let o;return t.forEach((t=>{const{time:s,text:n="",id:i}=t;s?(o=i,e.dateOptions=t.values.map((t=>{let{id:e,text:o}=t;return{caption:o,value:e}})).reverse()):e.push({c:(0,U.O)(n),v:i,options:K(t)})})),{mapFrequency:"Y",dims:e,timeId:o}},z=Array.isArray,G={month:"M",quarter:"K"},$=["Tid","Year","Month","Vuosi","VuosineljÃ¤nnes","Jahr"],W=(t,e)=>!z(t)||!z(e)||t.length!==e.length,X=t=>{let{values:e,valueTexts:o,code:s}=t;if(!W(e,o))return o.map(((t,o)=>B(t,s,e[o])))},tt=t=>{const e=[];let o,s="Y";return t.forEach((t=>{const{code:n,time:i}=t,r=t.text||"";((t,e)=>!t&&-1===$.indexOf(e)&&-1===(e+"").indexOf("TLIST("))(i,n)?e.push({c:(0,U.O)(r),v:n,options:X(t)}):(o=n,s=G[r.toLowerCase()],e.dateOptions=(t=>{let{values:e,valueTexts:o}=t;if(W(e,o))return;const s=[];return o.forEach(((t,o)=>{s.push({caption:t,value:e[o]})})),s.reverse()})(t))})),{mapFrequency:s,dims:e,timeId:o}},et=(t,e)=>fetch(t,e).then((t=>{const{status:e,statusText:o}=t;if(e>=200&&e<400)return t.json();if(403===e)throw Error("HTTP Code 403: Forbitten.\nMaybe, require API key.");throw Error("HTTP Code: "+e+" "+o)})),ot=Array.isArray,st=t=>{const e=[],{variables:o,dimension:s,source:n}=t;return((t,e)=>t&&"ESTAT"===e)(s,n)?H(s):ot(o)?(i=o[0])&&i.id&&i.text&&!ot(i.valueTexts)&&ot(i.values)?V(o):tt(o):{dims:e,timeId:undefined,mapFrequency:"Y"};var i},nt=t=>et(t).then(st);var it=o(8876);const rt=t=>"M"===t?"2019-01":"S"===t?"2019-S1":"Q"===t?"2019-Q1":"2019",at=(t,e)=>{let{dfNonTime:o,mapFrequency:s,dfId:n}=t;const i=(0,_.Bo)([e,o?"":"time="+rt(s)]).join("&"),r=i?"?"+i:"";return it.sS+"/"+n+r},ct={DF:t=>{let{proxy:e="",baseMeta:o,dfId:s}=t;return""+e+o+"/"+s},EU_STAT:at,FSO:t=>{let{proxy:e="",baseMeta:o,dfId:s}=t;return""+e+o+"/"+s+"/"+s+".px"}},dt=t=>t.dimUrl||(t=>(ct[t.loadId]||ct.DF)(t))(t),lt=(t,e,o)=>({id:t,caption:e,options:o}),pt=(t,e)=>{const o=e?((t,e)=>{const o=Object.create(null);return t.forEach((t=>{o[t.v]=t})),e.map((t=>{let{v:e,c:s}=t;return lt(e,s,o[e].options)}))})(t,e):(t=>t.map((t=>{let{c:e,v:o,options:s}=t;return lt(o,e,s)})))(t);return o.dateOptions=t.dateOptions,(t=>{t.forEach(((t,e)=>{const{options:o}=t;if(1===o.length){const e=o[0];t.placeholder=e.caption,t.dfItem=e,t.isRow=!1}}))})(o),o},ut=(t,e)=>{const o=dt(e),s=e.dims;return t.start(o),nt(o).then((t=>{let{dims:e,mapFrequency:o,timeId:n}=t;if(!(t=>{const e=t.length;let o=0;for(;o<e&&t[o].options;o++);return o===e})(e))throw{errMsg:"Loaded dims without options"};return{timeId:n,mapFrequency:o,configs:pt(e,s)}}))},ht=t=>(t.options||[]).length,mt=(t,e)=>{const{dfQ:o}=e,s=at(e,o[0]),n=at(e,o[1]);let i=[];return t.start(s),nt(s).then((t=>{let{dims:e}=t;i=i.concat(e)})).then((()=>{return t=5e3,new Promise((e=>{setTimeout((()=>e()),t)}));var t})).then((()=>(t.stop(),t.start(n),nt(n)))).then((t=>{let{dims:e,mapFrequency:o,timeId:s}=t;return i=(t=>{const e=Object.create(null);return t.forEach((t=>{const o=t.v,s=e[o];(!s||ht(s)<ht(t))&&(e[o]=t)})),Object.keys(e).map((t=>e[t]))})(i.concat(e)),{timeId:"time",mapFrequency:o,configs:pt(i)}}))},ft=Array.isArray,gt=new P,vt=t=>{let{errMsg:e,message:o}=t;return{errMsg:e||o}},yt=t=>{if(gt.isLoading)return Promise.resolve({errMsg:"Another dialog are still loading"});{const e=(t=>{const{dfQ:e}=t;return ft(e)?2===e.length?mt:void 0:ut})(t);return e?e(gt,t).catch(vt).finally((()=>gt.stop())):Promise.resolve({errMsg:"Incorrect dialog configuration"})}},Ot=(t,e)=>({caption:t,value:e}),bt=(t,e)=>{let{dims:o,proxy:s,baseMeta:n,loadId:i,mapFrequency:r,dfProps:a}=t;yt(Object.assign({dims:o,proxy:s,baseMeta:n,loadId:i,mapFrequency:r},a)).then(e).catch((t=>{e({errMsg:t.message})}))},wt=()=>({isLoading:!0,isLoadFailed:!1}),St=t=>t.map((t=>t.options)),Ct=t=>{const e=[];return t.forEach((t=>{(t.options||[]).length>1&&e.push(Ot(t.caption,t.id))})),e},At=(t,e)=>{const{chartsType:o,mapFrequency:n,mapDateDf:r,loadId:a,dfProps:c={}}=t,d=c.mapFrequency||n||"M",l=c.mapDateDf||r,[{isLoading:p,isLoadFailed:u},h]=(0,s.J0)(wt),[m,f]=(0,s.J0)({configs:[],selectOptions:[],mapFrequency:n,chartOptions:[],dateOptions:[]}),g=(0,s.hb)((t=>{let{configs:s,timeId:n,mapFrequency:r,errMsg:c}=t;if(s){const t=r||d,[e,c]=((t,e,o,s)=>{const{dateOptions:n}=t;if(n)return[n,n[0]];const[i,r]=(0,k.A)(e,o,s);return[i,Ot(r,r)]})(s,t,l,a);h({isLoading:!1,isLoadFailed:!1}),f({timeId:n,configs:s,selectOptions:St(s),mapFrequency:t,dimOptions:Ct(s),chartOptions:(0,i.O)(s,o,t),dateOptions:e,dateDf:c})}else h({isLoading:!1,isLoadFailed:!0}),e([c])}),[o,d,l,a,e]),v=((t,e)=>{const o=(0,E.A)(t.isShow);return e&&o})(t,u);return(0,s.vJ)((()=>{bt(t,g)}),[]),(0,s.vJ)((()=>{v&&(bt(t,g),h(wt))}),[v,t,g]),[m,p,u]},It=Object.assign({},(0,n.g2)(80,"45%"),{width:32,height:32,zIndex:8}),xt=t=>({width:t?350:267,height:72}),Tt=(t,e)=>t.dfC||(e||{}).value,Ft=(t,e)=>t.dfC||!e?"":e.caption||"",Lt={StatN:(0,w.A)((t=>{const{isShow:e,caption:o,dfProps:n,msgOnNotSelected:m,toTopLayer:f,onAbout:v,loadFn:O,onLoad:w,onShow:F,onClose:L}=t,{dfRt:j}=n||{},q=!t.dims&&!t.notDim,[M,E]=(0,s.J0)(),[k,P]=T(),_=(0,s.li)(),[J,N]=(0,S.NC)(),[U,B]=(0,S.NC)(),[Q,Y]=(0,S.NC)(j),[Z,H,K]=(0,C.A)(L),[V,z,G]=At(t,H),{configs:$,selectOptions:W,chartOptions:X,dimOptions:tt,dateOptions:et,dateDf:ot={},timeId:st}=V,[nt,it,rt,at,ct]=D($),dt=at[g],[lt,pt]=(0,A.A)(v),[ut,ht,mt,ft,gt]=(0,x.A)(),vt=(0,I.t)({toggleInputs:ct,toggleOptions:mt,onAbout:v}),yt=(0,s.hb)((()=>{const e=[];if(G)return e.push("Dims for request haven't been loaded.\nClose, open dialog for trying load again."),e;if(z)return e.push("Dims is loading"),e;const o=(0,i.y)(M),{dim:n}=M||{},r=((t,e,o,s)=>n=>{o.forEach(((o,i)=>{const{caption:r}=o;n(r)&&!s[i]&&t.push(e(r))}))})(e,m,$,(0,s.ZC)(k));if(!q||!o){const s=t.notDim?R:n;return r((t=>!(o&&t===s))),e}if(o){const t=B();if(!t)return e.push("Dim isn't selected"),e;r((e=>e!==t.caption))}return e}),[G,z,$,M,m]),Ot=(0,s.hb)((()=>{((t,e)=>{t.forEach(((t,o)=>{const{dfItem:s}=t;s&&e(o)(s)}))})($,P);const e=yt();if(0===e.length){const e=B();w(O(Object.assign({},t),Object.assign({},(0,s.y5)(_),{chartType:M,timeId:st,selectOptions:W,isCategory:(0,i.y)(M),dfC:Tt(t,e),dfTitle:Ft(t,e),time:(N()||ot).value,dialogOptions:(0,s.ZC)(ut),items:(0,s.ZC)(k),titles:(0,s.ZC)(it),_rt:Y()})))}H(e)}),[yt,ot,st,M,$,W]),bt=(0,c.JF)(z,G),wt=dt&&(0,i.y)(M);return(0,y.jsxs)(r.A,{isFocusBtMenu:!1,isShow:e,caption:o,menuModel:pt,toTopLayer:f,onLoad:Ot,onShow:F,onClose:K,children:[(0,y.jsx)(p.A,{isShow:lt,buttons:vt}),(0,y.jsx)(u.m,{isShow:ht,dfRt:j,onRoundTo:Q,toggleOption:gt,onClose:ft}),nt,(0,y.jsx)(c.y$,{style:It,status:bt}),bt?(0,y.jsx)("div",{style:xt(rt)}):(0,y.jsxs)(a.A,{is:e,children:[(0,y.jsx)(d.A,{items:$,crItem:b,isShowLabels:rt,isRow:at,fSelect:P}),(0,y.jsx)(h.A,{refSeriaColor:_,chartType:M,isShowLabels:rt,isShowChart:dt,isShowDate:wt,chartOptions:X,onSelectChart:E,dateDefault:ot.caption,dateOptions:et,onSelectDate:J,isDim:q,dimOptions:tt,onSelectDim:U})]}),(0,y.jsx)(l.A,{validationMessages:Z})]})}))}}}]);